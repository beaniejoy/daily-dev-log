> - 200425 dev log
> - cagong-ranking-project  
> - spring-boot, MySQL, IntelliJ  

<br>

## ğŸ”– 1. Paginationìœ¼ë¡œ search page êµ¬ì„±í•˜ê¸°


```java
// CafeService.java
    public Map<String, Object> getCafes(Pageable pageable) {
        Page<Cafe> cafes = cafeRepositoy.findAll(pageable);

        List<CafeApiResponse> cafeApiResponseList = cafes.stream()
                .map(cafe -> {
                    CafeApiResponse cafeApiResponse = CafeApiResponse.builder()
                            .id(cafe.getId())
                            .name(cafe.getName())
                            .imgUrl(cafe.getImgUrl())
                            .build();

                    return cafeApiResponse;
                })
                .collect(Collectors.toList());

        Pagination pagination = Pagination.builder()
                .totalPages(cafes.getTotalPages())
                .totalElements(cafes.getTotalElements())
                .currentPage(cafes.getNumber())
                .currentElements(cafes.getNumberOfElements())
                .build();

        Map<String, Object> cafePageMap = new HashMap<>();
        cafePageMap.put("cafes", cafeApiResponseList);
        cafePageMap.put("page", pagination);

        return cafePageMap;
    }
```
- Serviceì— í•´ë‹¹í•˜ëŠ” ë¶€ë¶„ì—ì„œ paginationê³¼ ê´€ë ¨ëœ êµ¬ì²´ì ì¸ business logic ì‘ì„±
- `CafeApiResponse`ì™€ `Pagination` ê°ì²´ë¥¼ ë§Œë“¤ì–´ ê°ê° í•´ë‹¹í•˜ëŠ” ì •ë³´ë“¤ì„ ë„£ê³  `Map<String, Object>`í˜•ì‹ìœ¼ë¡œ ê°ì²´ë“¤ì„ ë¬¶ì–´ì£¼ì—ˆë‹¤.
- `CafeApiResponse`: id, name, img_urlì— ëŒ€í•œ ë°ì´í„°ë¥¼ ë‹´ëŠ”ë‹¤.
- `Pagination`: totalPages(ì „ì²´ í˜ì´ì§€ìˆ˜), totalElements(ì „ì²´ ë°ì´í„° ìˆ˜), currentPage(í˜„ì¬ í˜ì´ì§€ ë„˜ë²„, 0ë¶€í„°), currentElements(í˜„ì¬ í˜ì´ì§€ì˜ ë°ì´í„° ìˆ˜)

<br>

```java
// CafeController.java
    @GetMapping("/search")
    public String list(Model model,
                       @PageableDefault(sort = "id", direction = Sort.Direction.ASC, size = 4) Pageable pageable) {
        model.addAttribute("cafes", cafeService.getCafes(pageable).get("cafes"));
        model.addAttribute("page", cafeService.getCafes(pageable).get("page"));
        return "search";
    }
```
- Viewì— ì „ë‹¬í•˜ê¸° ìœ„í•´ `cafes` ë°ì´í„° ë¦¬ìŠ¤íŠ¸ì™€ `page` ê°ì²´ë¥¼ ì „ë‹¬í•´ì¤€ë‹¤.
- `size` parameterë¡œ í•œ í˜ì´ì§€ì—ì„œì˜ ë°ì´í„° ê°œìˆ˜ë¥¼ ì§€ì •í•  ìˆ˜ ìˆë‹¤.

<br>

```html
<ul class="pagination justify-content-center"
    th:with="startNum = *{(currentPage / maxSize) * maxSize},
             countNum = ${startNum} + *{maxSize} >= *{totalPages} ? *{totalPages} - ${startNum + 1} : *{maxSize}">
    <li class="page-item" th:classappend="*{currentPage} == 0? disabled">
        <a class="page-link" th:href="@{/cafes/search(page=*{currentPage - 1})}"
           tabindex="-1" aria-disabled="true">Previous</a>
    </li>

    <li class="page-item" th:each="num : ${#numbers.sequence(0, countNum)}">
        <a class="page-link"
           th:href="@{/cafes/search(page=${num + startNum})}"
           th:text="${num + startNum + 1}">
        </a>
    </li>

    <li class="page-item" th:classappend="*{currentPage + 1 >= totalPages}? disabled">
        <a class="page-link" th:href="@{/cafes/search(page=*{currentPage + 1})}"
           tabindex="-1" aria-disabled="true">Next</a>
    </li>
</ul>
```
- `startNum`: pagination bar blockì˜ ì‹œì‘í˜ì´ì§€
- `countNum`: í•œ blockì˜ ì‹¤ì œ í˜ì´ì§€ ê°œìˆ˜, ë§ˆì§€ë§‰ blockì—ì„œ totalPagesì™€ ì‹œì‘í˜ì´ì§€ì˜ ì°¨ì´
- `currentPage`: í˜„ì¬ í˜ì´ì§€ê°€ 0ì´ë©´ Previousê°€ disabled, totalPagesë³´ë‹¤ í¬ë©´ Nextê°€ disabled
- `th:classappend`: ? ì¡°ê±´ì‹ templateì„ ì´ìš©í•´ì„œ ì¡°ê±´ì— í•´ë‹¹í•˜ë©´ disabled ì²˜ë¦¬ 