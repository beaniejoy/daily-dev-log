> - 200516 dev log
> - cagong-ranking-project  
> - spring-boot, MySQL, IntelliJ  

<br>

## ğŸ”– 1. `iframe` tagë¥¼ ì´ìš©í•´ ëŒ“ê¸€ ë¦¬ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°

```html
<iframe th:attr="src=@{/cafes/{cafeId}/comments(cafeId=${cafe.id})}"
        width="100%" height="500px" frameborder="0"></iframe>
```
- `iframe` tagë¥¼ ì´ìš©í•´ì„œ ë¹„ë™ê¸° í†µì‹ ì²˜ëŸ¼ í•´ë‹¹ êµ¬ì—­ì— ëŒ€í•´ì„œë§Œ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ì„ ìˆ˜ ìˆë‹¤.
- `th:attr` ì„¤ì •ì„ í†µí•´ì„œ `src` ì†ì„±ì„ ì„¤ì •í•´ì¤€ë‹¤. ì—¬ê¸°ì„œ GetMappingì— í•´ë‹¹í•˜ëŠ” urlì„ mappingí•´ì¤„ ìˆ˜ë„ ìˆë‹¤.

```java
// CommentController.java
@GetMapping("/cafes/{cafeId}/comments")
public String list(Model model,
                    @PathVariable Long cafeId,
                    @PageableDefault(sort = "id", direction = Sort.Direction.ASC, size = 10) Pageable pageable) {
    model.addAttribute("comments", reviewService.getComments(cafeId, pageable).get("comments"));
    model.addAttribute("page", reviewService.getComments(cafeId, pageable).get("page"));
    model.addAttribute("cafeId", cafeId);
    return "view/comment";
}
```
- Commentì— ëŒ€í•´ì„œë„ Pageable ì„¤ì •ì„ í•´ì£¼ì–´ Pagination ì ìš©í•œë‹¤.

```java
// ReviewService.java
public Map<String, Object> getComments(Long cafeId, Pageable pageable) {
    Page<Review> reviews = reviewRepository.findAllByCafeId(cafeId, pageable);

    List<CommentApiResponse> comments = reviews.stream()
            .map(review -> {
                return CommentApiResponse.builder()
                        .id(review.getId())
                        .account(review.getUser().getAccount())
                        .content(review.getComment())
                        .build();
            })
            .collect(Collectors.toList());

    Pagination pagination = Pagination.builder()
            .totalPages(reviews.getTotalPages())
            .totalElements(reviews.getTotalElements())
            .currentPage(reviews.getNumber())
            .currentElements(reviews.getNumberOfElements())
            .build();

    Map<String, Object> commentPageMap = new HashMap<>();
    commentPageMap.put("comments", comments);
    commentPageMap.put("page", pagination);

    return commentPageMap;
}
```
- ì§€ê¸ˆì€ Review tableì— Comment ì¹¼ëŸ¼ì„ ê°€ì§€ê³  ì™”ê¸° ë•Œë¬¸ì— `ReviewService`ì—ì„œ business logic ì²˜ë¦¬
- ì´í›„ì— Comment tableì„ ë”°ë¡œ êµ¬ì„±í•´ Serviceë„ ë¶„ë¦¬í•´ì•¼ í•œë‹¤.

```html
<div class="form-group" th:if="${comments}" th:each="comment : ${comments}">
    <label th:text="${comment.account}"></label>
    <textarea class="form-control" rows="3" readonly="readonly" th:text="${comment.content}"></textarea>
</div>

<div th:if="!${comments}">
    <h4>ë¦¬ë·°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</h4>
</div>
```
- `th:if`ë¥¼ ì´ìš©í•´ commentsì˜ ê°ì²´ê°€ nullì¸ì§€ ì•„ë‹Œì§€ì— ë”°ë¼ í•´ë‹¹í•˜ëŠ” div tagë¥¼ ë³´ë‚¸ë‹¤.

