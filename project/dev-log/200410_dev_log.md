> - 200410 log
> - cagong-ranking-project  
> - spring-boot, IntelliJ  


## ğŸ”– 1.
> JUnit 5 ì‚¬ìš©


```java
// CafeControllerTests.java
@Test
public void createWithCorrectData() throws Exception {
    given(cafeService.addCafe(any())).will(invocation -> {
        Cafe cafe = invocation.getArgument(0);
        return Cafe.builder()
                .id(2L)
                .name(cafe.getName())
                .address(cafe.getAddress())
                .build();
    });

    mvc.perform(post("/cafes")
            .contentType(MediaType.APPLICATION_JSON)
            .content("{\"name\":\"Hollys\",\"address\":\"Seoul\"}")
    )
            .andExpect(status().isCreated())
            .andExpect(header().string("location", "/cafes/2"))
            .andExpect(content().string("{}"));

    verify(cafeService).addCafe(any());
}
```
ì—¬ê¸°ì„œ create, ì¦‰ ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ insertí•  ë•Œ will invocationì„ í†µí•´ idê°’ì„ ì •í•´ì£¼ì–´ì•¼ í•œë‹¤.  
NullPointerExceptionì´ ë°œìƒí•œë‹¤.
```java
// CafeController.java
Cafe cafe = cafeService.addCafe(Cafe.builder()
        .name(resource.getName())
        .address(resource.getAddress())
        .build());

String url = "/cafes/" + cafe.getId();
```
createí•  ë•Œ urlì„ ë°˜í™˜ëœ idê°’ìœ¼ë¡œ ë§Œë“¤ê¸° ë•Œë¬¸ì´ë‹¤.

## ğŸ”– 2.

```java
verify(cafeMenuService).bulkUpdate(eq(1L), any());
```
![image](https://user-images.githubusercontent.com/41675375/78996693-19f8fd80-7b80-11ea-8057-cd1513b823b8.png)

verifyë¥¼ í†µí•´ ë™ì‘í–ˆëŠ”ì§€ë¥¼ ê²€ì‚¬í•˜ë ¤ê³  í•  ë•Œ valueì— ëŒ€í•´ì„œ eqë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

## ğŸ”– 3.

```java
// CafeMenuService.java
public void bulkUpdate(Long cafeId, List<CafeMenu> cafeMenus) {
    for (CafeMenu cafeMenu : cafeMenus) {
        if(cafeMenu.isDestroy()){
            cafeMenuRepository.deleteById(cafeMenu.getId());
            continue;
        }
        cafeMenu.setCafeId(cafeId);
        cafeMenuRepository.save(cafeMenu);
    }
}
```
ì—¬ê¸°ì„œ deleteById í•  ë•Œ existsByIdë¥¼ í†µí•´ í•´ë‹¹ cafemenuê°€ ì¡´ì¬í•˜ëŠ”ì§€ ì•„ë‹Œì§€ í™•ì¸í•  í•„ìš”ê°€ ì—†ë‹¤. ì• ì´ˆì— UIì—ì„œ ì´ë¯¸ ì €ì¥ëœ cafemenuë¥¼ ëŒ€ìƒìœ¼ë¡œ ë°”ê¾¸ê±°ë‚˜ ìƒˆë¡œ ì¶”ê°€í•˜ê±°ë‚˜ í•  ê²ƒì´ê¸° ë•Œë¬¸ì— ì‚¬ìš©ìê°€ ì´ìƒí•œ idë¥¼ ì ‘ê·¼ì¡°ì°¨ í•  ìˆ˜ ì—†ë‹¤.

ê·¸ë¦¬ê³  save í•  ë•Œ cafeMenuì— ì…ë ¥ë°›ì€ idê°€ ìˆëŠ”ì§€ ì•„ë‹Œì§€ë¡œ ë˜ ë‚˜ë‰˜ëŠ”ë° idê°€ ì…ë ¥ì´ ë˜ì–´ìˆìœ¼ë©´ ê·¸ í•´ë‹¹ idì— ë®ì–´ì”Œìš°ëŠ” ë°©ì‹ìœ¼ë¡œ ì €ì¥í•˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ê·¸ë˜ì„œ save í•˜ë‚˜ë¡œ updateì™€ ìƒˆë¡œìš´ ë°ì´í„° insertê°€ ë™ì‹œì— ê°€ëŠ¥í•˜ë‹¤.

```java
// CafeMenu.java
@Transient
@JsonInclude(JsonInclude.Include.NON_NULL)
private boolean destroy;
```
CafeMenuì— destroyë¥¼ Transient í•´ì„œ DBì— ë„£ì§€ ì•ŠëŠ” ì´ìœ ëŠ” destroyí•  ëŒ€ìƒì¸ì§€ ì•„ë‹Œì§€ë§Œ íŒë‹¨í•˜ëŠ” ê²ƒì´ë¯€ë¡œ êµ³ì´ DBì— ì €ì¥í•  í•„ìš”ê°€ ì—†ë‹¤. ì–´ì°¨í”¼ ì‚¬ë¼ì§ˆ ë°ì´í„°ì´ë¯€ë¡œ. ê·¸ë¦¬ê³  defaultë¡œ falseê°€ ì €ì¥ëœë‹¤.
